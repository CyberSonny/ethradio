###############################################################################
#                                                                             #
#                                                       17/Feb/2010  19:07:03 #
# IAR C/C++ Compiler V5.30.0.20166/W32, Evaluation Version  for Atmel AVR     #
# Copyright 1996-2009 IAR Systems AB.                                         #
#                                                                             #
#    Source file  =  G:\AVR\EthRadio_buf_inline\lcd.c                         #
#    Command line =  --string_literals_in_flash G:\AVR\EthRadio_buf_inline\lc #
#                    d.c --cpu=m32 -ms -o G:\AVR\EthRadio_buf_inline\Debug\Ob #
#                    j\ -lC G:\AVR\EthRadio_buf_inline\Debug\List\ -lB        #
#                    G:\AVR\EthRadio_buf_inline\Debug\List\                   #
#                    --initializers_in_flash -s9 --no_code_motion --debug     #
#                    -DENABLE_BIT_DEFINITIONS -e -I "C:\Program Files\IAR     #
#                    Systems\Embedded Workbench Evaluation 5.3\avr\INC\" -I   #
#                    "C:\Program Files\IAR Systems\Embedded Workbench         #
#                    Evaluation 5.3\avr\INC\CLIB\" --eeprom_size 1024         #
#                    --lock_regs=1                                            #
#    List file    =  G:\AVR\EthRadio_buf_inline\Debug\List\lcd.lst            #
#    Object file  =  G:\AVR\EthRadio_buf_inline\Debug\Obj\lcd.r90             #
#                                                                             #
#                                                                             #
###############################################################################

G:\AVR\EthRadio_buf_inline\lcd.c
      1          
      2          #include "compiler.h"

   \                                 In  segment ABSOLUTE, at 0x33
   \   <__C40> volatile __io _A_PINC
   \                     _A_PINC:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x34
   \   <__C42> volatile __io _A_DDRC
   \                     _A_DDRC:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x35
   \   <__C44> volatile __io _A_PORTC
   \                     _A_PORTC:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x59
   \   <__C118> volatile __io _A_TIMSK
   \                     _A_TIMSK:
   \   00000000                      DS8 1
      3          #include "stdafx.h"
      4          #include "lcd.h"
      5          
      6          #define LCD_CLR               0      /* DB0: clear display                  */
      7          #define LCD_HOME              1      /* DB1: return to home position        */
      8          
      9          #define LCD_ENTRY_MODE        2      /* DB2: set entry mode                 */
     10          #define LCD_ENTRY_INC         1      /*   DB1: 1=increment, 0=decrement     */
     11          #define LCD_ENTRY_SHIFT       0      /*   DB2: 1=display shift on           */
     12          
     13          #define LCD_ON                3      /* DB3: turn lcd/cursor on             */
     14          #define LCD_ON_DISPLAY        2      /*   DB2: turn display on              */
     15          #define LCD_ON_CURSOR         1      /*   DB1: turn cursor on               */
     16          #define LCD_ON_BLINK          0      /*     DB0: blinking cursor ?          */
     17          
     18          #define LCD_MOVE              4      /* DB4: move cursor/display            */
     19          #define LCD_MOVE_DISP         3      /*   DB3: move display (0-> cursor) ?  */
     20          #define LCD_MOVE_RIGHT        2      /*   DB2: move right (0-> left) ?      */
     21          
     22          #define LCD_FUNCTION          5      /* DB5: function set                   */
     23          #define LCD_FUNCTION_8BIT     4      /*   DB4: set 8BIT mode (0->4BIT mode) */
     24          #define LCD_FUNCTION_2LINES   3      /*   DB3: two lines (0->one line)      */
     25          #define LCD_FUNCTION_10DOTS   2      /*   DB2: 5x10 font (0->5x7 font)      */
     26          
     27          #define LCD_CGRAM             6      /* DB6: set CG RAM address             */
     28          #define LCD_DDRAM             7      /* DB7: set DD RAM address             */
     29          #define LCD_BUSY              7      /* DB7: LCD is busy                    */
     30          
     31          /* set entry mode: display shift on/off, dec/inc cursor move direction */
     32          #define LCD_ENTRY_DEC            0x04   /* display shift off, dec cursor move dir */
     33          #define LCD_ENTRY_DEC_SHIFT      0x05   /* display shift on,  dec cursor move dir */
     34          #define LCD_ENTRY_INC_           0x06   /* display shift off, inc cursor move dir */
     35          #define LCD_ENTRY_INC_SHIFT      0x07   /* display shift on,  inc cursor move dir */
     36          
     37          /* display on/off, cursor on/off, blinking char at cursor position */
     38          #define LCD_DISP_OFF             0x08   /* display off                            */
     39          #define LCD_DISP_ON              0x0C   /* display on, cursor off                 */
     40          #define LCD_DISP_ON_BLINK        0x0D   /* display on, cursor off, blink char     */
     41          #define LCD_DISP_ON_CURSOR       0x0E   /* display on, cursor on                  */
     42          #define LCD_DISP_ON_CURSOR_BLINK 0x0F   /* display on, cursor on, blink char      */
     43          
     44          /* move cursor/shift display */
     45          #define LCD_MOVE_CURSOR_LEFT     0x10   /* move cursor left  (decrement)          */
     46          #define LCD_MOVE_CURSOR_RIGHT    0x14   /* move cursor right (increment)          */
     47          #define LCD_MOVE_DISP_LEFT       0x18   /* shift display left                     */
     48          #define LCD_MOVE_DISP_RIGHT      0x1C   /* shift display right                    */
     49          
     50          /* function set: set interface data length and number of display lines */
     51          #define LCD_FUNCTION_4BIT_1LINE  0x20   /* 4-bit interface, single line, 5x7 dots */
     52          #define LCD_FUNCTION_4BIT_2LINES 0x28   /* 4-bit interface, dual line,   5x7 dots */
     53          #define LCD_FUNCTION_8BIT_1LINE  0x30   /* 8-bit interface, single line, 5x7 dots */
     54          #define LCD_FUNCTION_8BIT_2LINES 0x38   /* 8-bit interface, dual line,   5x7 dots */
     55          
     56          #define LCD_MODE_DEFAULT     ((1<<LCD_ENTRY_MODE) | (1<<LCD_ENTRY_INC) )
     57          
     58          #define LCD_PORT  PORTC
     59          #define LCD_DDR   DDRC
     60          #define LCD_RS    PC4
     61          #define LCD_RW    PC5
     62          #define LCD_E     PC6
     63          #define LCD_PIN   PINC
     64          
     65          #define LCD_toggle_e()  sbi(LCD_PORT, LCD_E); __delay_cycles (XTALL/2);  cbi(LCD_PORT, LCD_E);
     66          
     67          #pragma inline = forced
     68          UREG LCD_RD (UREG mode)
     69          {  
     70            //LCD_PORT|=0x0F;
     71            if (mode==0)
     72            {
     73              cbi (LCD_PORT, LCD_RS); //  Read busy flag (DB7) and address counter (DB0 to DB7)
     74            }
     75            else
     76            {
     77              sbi (LCD_PORT, LCD_RS); //  Read data from DDRAM or CGRAM (DDRAM or CGRAM to DR)
     78            }    
     79            sbi (LCD_PORT, LCD_RW); // read mode
     80            
     81            LCD_DDR&= ~(0x0F); // D3-D0 as input
     82            
     83            sbi (LCD_PORT, LCD_E);
     84            __delay_cycles (XTALL/2);
     85            UREG data = LCD_PIN<<4; //read high nibble
     86            cbi (LCD_PORT, LCD_E);  
     87            __delay_cycles (XTALL/2);
     88            sbi (LCD_PORT, LCD_E);
     89            __delay_cycles (XTALL/2);
     90            data |= (LCD_PIN&0x0F); //read low nibble  
     91            cbi (LCD_PORT, LCD_E);  
     92              __delay_cycles (XTALL/2);
     93            LCD_PORT|=0x0F;
     94            return data;        
     95          }
     96          
     97          #pragma inline = forced
     98          void LCD_WR (UREG data, UREG mode)
     99          {
    100            if (mode) //mode == 1 "Data write"
    101            {
    102             sbi (LCD_PORT, LCD_RS);
    103            }
    104            else //mode == 0 "Instruction write"
    105            {
    106             cbi (LCD_PORT, LCD_RS);
    107            }
    108            cbi (LCD_PORT, LCD_RW);   
    109            LCD_DDR|= 0x0F; // D3-D0 as outputs
    110            LCD_PORT = (LCD_PORT & (0xF0))|(data>>4); //output MSB nibble
    111            LCD_toggle_e();
    112            LCD_PORT = (LCD_PORT & (0xF0))|(data&0x0F); //output LSB nibble
    113            LCD_toggle_e();
    114            LCD_PORT|=0x0F;
    115          }
    116          
    117          #pragma inline = forced
    118          UREG LCD_busy_AC_RD (void)
    119          {
    120            while (LCD_RD(0)&(1<<7));
    121          //  _delay_us(4);
    122             return (LCD_RD(0));  // return address counter
    123          }
    124          
    125          //#pragma inline = forced

   \                                 In  segment CODE, align 2, keep-with-next
    126          void LCD_CMD (UREG cmd)
   \                     LCD_CMD:
   \                     ??LCD_CMD_0:
    127          {
    128            LCD_busy_AC_RD();
   \   00000000   98AC               CBI     0x15, 0x04
   \   00000002   9AAD               SBI     0x15, 0x05
   \   00000004   B314               IN      R17, 0x14
   \   00000006   7F10               ANDI    R17, 0xF0
   \   00000008   BB14               OUT     0x14, R17
   \   0000000A   9AAE               SBI     0x15, 0x06
   \   0000000C   C000               RJMP    $+2
   \   0000000E   C000               RJMP    $+2
   \   00000010   C000               RJMP    $+2
   \   00000012   C000               RJMP    $+2
   \   00000014   B323               IN      R18, 0x13
   \   00000016   9522               SWAP    R18
   \   00000018   7F20               ANDI    R18, 0xF0
   \   0000001A   98AE               CBI     0x15, 0x06
   \   0000001C   C000               RJMP    $+2
   \   0000001E   C000               RJMP    $+2
   \   00000020   C000               RJMP    $+2
   \   00000022   C000               RJMP    $+2
   \   00000024   9AAE               SBI     0x15, 0x06
   \   00000026   C000               RJMP    $+2
   \   00000028   C000               RJMP    $+2
   \   0000002A   C000               RJMP    $+2
   \   0000002C   C000               RJMP    $+2
   \   0000002E   B313               IN      R17, 0x13
   \   00000030   701F               ANDI    R17, 0x0F
   \   00000032   2B21               OR      R18, R17
   \   00000034   98AE               CBI     0x15, 0x06
   \   00000036   C000               RJMP    $+2
   \   00000038   C000               RJMP    $+2
   \   0000003A   C000               RJMP    $+2
   \   0000003C   C000               RJMP    $+2
   \   0000003E   B315               IN      R17, 0x15
   \   00000040   601F               ORI     R17, 0x0F
   \   00000042   BB15               OUT     0x15, R17
   \   00000044   FB27               BST     R18, 7
   \   00000046   F2E6               BRTS    ??LCD_CMD_0
   \   00000048   98AC               CBI     0x15, 0x04
   \   0000004A   9AAD               SBI     0x15, 0x05
   \   0000004C   B314               IN      R17, 0x14
   \   0000004E   7F10               ANDI    R17, 0xF0
   \   00000050   BB14               OUT     0x14, R17
   \   00000052   9AAE               SBI     0x15, 0x06
   \   00000054   C000               RJMP    $+2
   \   00000056   C000               RJMP    $+2
   \   00000058   C000               RJMP    $+2
   \   0000005A   C000               RJMP    $+2
   \   0000005C   B313               IN      R17, 0x13
   \   0000005E   98AE               CBI     0x15, 0x06
   \   00000060   C000               RJMP    $+2
   \   00000062   C000               RJMP    $+2
   \   00000064   C000               RJMP    $+2
   \   00000066   C000               RJMP    $+2
   \   00000068   9AAE               SBI     0x15, 0x06
   \   0000006A   C000               RJMP    $+2
   \   0000006C   C000               RJMP    $+2
   \   0000006E   C000               RJMP    $+2
   \   00000070   C000               RJMP    $+2
   \   00000072   B313               IN      R17, 0x13
   \   00000074   98AE               CBI     0x15, 0x06
   \   00000076   C000               RJMP    $+2
   \   00000078   C000               RJMP    $+2
   \   0000007A   C000               RJMP    $+2
   \   0000007C   C000               RJMP    $+2
   \   0000007E   B315               IN      R17, 0x15
   \   00000080   601F               ORI     R17, 0x0F
   \   00000082   BB15               OUT     0x15, R17
    129            LCD_WR(cmd,0);  
   \   00000084   98AC               CBI     0x15, 0x04
   \   00000086   98AD               CBI     0x15, 0x05
   \   00000088   B314               IN      R17, 0x14
   \   0000008A   601F               ORI     R17, 0x0F
   \   0000008C   BB14               OUT     0x14, R17
   \   0000008E   B325               IN      R18, 0x15
   \   00000090   7F20               ANDI    R18, 0xF0
   \   00000092   2F10               MOV     R17, R16
   \   00000094   9512               SWAP    R17
   \   00000096   701F               ANDI    R17, 0x0F
   \   00000098   2B21               OR      R18, R17
   \   0000009A   BB25               OUT     0x15, R18
   \   0000009C   9AAE               SBI     0x15, 0x06
   \   0000009E   C000               RJMP    $+2
   \   000000A0   C000               RJMP    $+2
   \   000000A2   C000               RJMP    $+2
   \   000000A4   C000               RJMP    $+2
   \   000000A6   98AE               CBI     0x15, 0x06
   \   000000A8   B315               IN      R17, 0x15
   \   000000AA   7F10               ANDI    R17, 0xF0
   \   000000AC   700F               ANDI    R16, 0x0F
   \   000000AE   2B10               OR      R17, R16
   \   000000B0   BB15               OUT     0x15, R17
   \   000000B2   9AAE               SBI     0x15, 0x06
   \   000000B4   C000               RJMP    $+2
   \   000000B6   C000               RJMP    $+2
   \   000000B8   C000               RJMP    $+2
   \   000000BA   C000               RJMP    $+2
   \   000000BC   98AE               CBI     0x15, 0x06
   \   000000BE   B305               IN      R16, 0x15
   \   000000C0   600F               ORI     R16, 0x0F
   \   000000C2   BB05               OUT     0x15, R16
    130          }
   \   000000C4   9508               RET
   \   000000C6                      REQUIRE _A_DDRC
   \   000000C6                      REQUIRE _A_PORTC
   \   000000C6                      REQUIRE _A_PINC
    131          

   \                                 In  segment CODE, align 2, keep-with-next
    132          void LCD_DATA (UREG data)
   \                     LCD_DATA:
    133          {
    134          }
   \   00000000   9508               RET
    135          
    136          

   \                                 In  segment NEAR_F, align 1, keep-with-next
    137          __flash char WIN1251_tab[]={'A',0xa0,'B',0xa1,0xe0,'E',0xa3,\
   \                     WIN1251_tab:
   \   00000000   A041A14245E0       DC8 65, 160, 66, 161, 224, 69, 163, 164, 165, 166, 75, 167, 77, 72, 79
   \              A4A3A6A5A74B
   \              484D4F      
   \   0000000F   50A85443AAA9       DC8 168, 80, 67, 84, 169, 170, 88, 225, 171, 172, 226, 173, 174, 98
   \              E158ACABADE2
   \              62AE        
   \   0000001D   B0AF61B1B3B2       DC8 175, 176, 177, 97, 178, 179, 180, 227, 101, 182, 183, 184, 185, 186
   \              E3B4B665B8B7
   \              BAB9        
   \   0000002B   BCBB6FBD70BE       DC8 187, 188, 189, 111, 190, 112, 99, 191, 121, 228, 120, 229, 192, 193
   \              BF63E479E578
   \              C1C0        
   \   00000039   C2E6C4C3C6C5       DC8 230, 194, 195, 196, 197, 198, 199
   \              C7          
    138          0xa4,0xa5,0xa6,'K',0xa7,'M','H','O',0xa8,'P','C','T',0xa9,0xaa,'X',0xe1,0xab,0xac,0xe2,0xad,\
    139          0xae,'b',0xaf,0xb0,0xb1,\
    140          'a',0xb2,0xb3,0xb4,0xe3,'e',0xb6,0xb7,0xb8,0xb9,0xba,0xbb,0xbc,0xbd,'o',0xbe,'p','c',0xbf,'y',\
    141          0xe4,'x',0xe5,0xc0,0xc1,0xe6,0xc2,0xc3,0xc4,0xc5,0xc6,0xc7};
    142          
    143          //#pragma inline = forced

   \                                 In  segment CODE, align 2, keep-with-next
    144          void LCD_putc(char c)
   \                     LCD_putc:
   \                     ??LCD_putc_0:
    145          {
    146              UREG sym;
    147              UREG pos;    
    148              pos = LCD_busy_AC_RD();   // read busy-flag and address counter     
   \   00000000   98AC               CBI     0x15, 0x04
   \   00000002   9AAD               SBI     0x15, 0x05
   \   00000004   B314               IN      R17, 0x14
   \   00000006   7F10               ANDI    R17, 0xF0
   \   00000008   BB14               OUT     0x14, R17
   \   0000000A   9AAE               SBI     0x15, 0x06
   \   0000000C   C000               RJMP    $+2
   \   0000000E   C000               RJMP    $+2
   \   00000010   C000               RJMP    $+2
   \   00000012   C000               RJMP    $+2
   \   00000014   B323               IN      R18, 0x13
   \   00000016   9522               SWAP    R18
   \   00000018   7F20               ANDI    R18, 0xF0
   \   0000001A   98AE               CBI     0x15, 0x06
   \   0000001C   C000               RJMP    $+2
   \   0000001E   C000               RJMP    $+2
   \   00000020   C000               RJMP    $+2
   \   00000022   C000               RJMP    $+2
   \   00000024   9AAE               SBI     0x15, 0x06
   \   00000026   C000               RJMP    $+2
   \   00000028   C000               RJMP    $+2
   \   0000002A   C000               RJMP    $+2
   \   0000002C   C000               RJMP    $+2
   \   0000002E   B313               IN      R17, 0x13
   \   00000030   701F               ANDI    R17, 0x0F
   \   00000032   2B21               OR      R18, R17
   \   00000034   98AE               CBI     0x15, 0x06
   \   00000036   C000               RJMP    $+2
   \   00000038   C000               RJMP    $+2
   \   0000003A   C000               RJMP    $+2
   \   0000003C   C000               RJMP    $+2
   \   0000003E   B315               IN      R17, 0x15
   \   00000040   601F               ORI     R17, 0x0F
   \   00000042   BB15               OUT     0x15, R17
   \   00000044   FB27               BST     R18, 7
   \   00000046   F2E6               BRTS    ??LCD_putc_0
   \   00000048   98AC               CBI     0x15, 0x04
   \   0000004A   9AAD               SBI     0x15, 0x05
   \   0000004C   B314               IN      R17, 0x14
   \   0000004E   7F10               ANDI    R17, 0xF0
   \   00000050   BB14               OUT     0x14, R17
   \   00000052   9AAE               SBI     0x15, 0x06
   \   00000054   C000               RJMP    $+2
   \   00000056   C000               RJMP    $+2
   \   00000058   C000               RJMP    $+2
   \   0000005A   C000               RJMP    $+2
   \   0000005C   B313               IN      R17, 0x13
   \   0000005E   98AE               CBI     0x15, 0x06
   \   00000060   C000               RJMP    $+2
   \   00000062   C000               RJMP    $+2
   \   00000064   C000               RJMP    $+2
   \   00000066   C000               RJMP    $+2
   \   00000068   9AAE               SBI     0x15, 0x06
   \   0000006A   C000               RJMP    $+2
   \   0000006C   C000               RJMP    $+2
   \   0000006E   C000               RJMP    $+2
   \   00000070   C000               RJMP    $+2
   \   00000072   B313               IN      R17, 0x13
   \   00000074   98AE               CBI     0x15, 0x06
   \   00000076   C000               RJMP    $+2
   \   00000078   C000               RJMP    $+2
   \   0000007A   C000               RJMP    $+2
   \   0000007C   C000               RJMP    $+2
   \   0000007E   B315               IN      R17, 0x15
   \   00000080   601F               ORI     R17, 0x0F
   \   00000082   BB15               OUT     0x15, R17
    149              if (c>=0xc0) sym=WIN1251_tab[c-0xc0];
   \   00000084   3C00               CPI     R16, 192
   \   00000086   F030               BRCS    ??LCD_putc_1
   \   00000088   E0F0               LDI     R31, 0
   \   0000008A   2FE0               MOV     R30, R16
   \   0000008C   ....               SUBI    R30, LOW((-(WIN1251_tab - 192) & 0xFFFF))
   \   0000008E   ....               SBCI    R31, HIGH((-(WIN1251_tab - 192) & 0xFFFF))
   \   00000090   9114               LPM     R17, Z
   \   00000092   C009               RJMP    ??LCD_putc_2
    150              else if (c==0xa8) sym=0xa2;
   \                     ??LCD_putc_1:
   \   00000094   3A08               CPI     R16, 168
   \   00000096   F411               BRNE    ??LCD_putc_3
   \   00000098   EA12               LDI     R17, 162
   \   0000009A   C005               RJMP    ??LCD_putc_2
    151              else if (c==0xb8) sym=0xb5;
   \                     ??LCD_putc_3:
   \   0000009C   3B08               CPI     R16, 184
   \   0000009E   F411               BRNE    ??LCD_putc_4
   \   000000A0   EB15               LDI     R17, 181
   \   000000A2   C001               RJMP    ??LCD_putc_2
    152              else sym=c;
   \                     ??LCD_putc_4:
   \   000000A4   2F10               MOV     R17, R16
    153              LCD_WR(sym, 1);
   \                     ??LCD_putc_2:
   \   000000A6   9AAC               SBI     0x15, 0x04
   \   000000A8   98AD               CBI     0x15, 0x05
   \   000000AA   B304               IN      R16, 0x14
   \   000000AC   600F               ORI     R16, 0x0F
   \   000000AE   BB04               OUT     0x14, R16
   \   000000B0   B325               IN      R18, 0x15
   \   000000B2   7F20               ANDI    R18, 0xF0
   \   000000B4   2F01               MOV     R16, R17
   \   000000B6   9502               SWAP    R16
   \   000000B8   700F               ANDI    R16, 0x0F
   \   000000BA   2B20               OR      R18, R16
   \   000000BC   BB25               OUT     0x15, R18
   \   000000BE   9AAE               SBI     0x15, 0x06
   \   000000C0   C000               RJMP    $+2
   \   000000C2   C000               RJMP    $+2
   \   000000C4   C000               RJMP    $+2
   \   000000C6   C000               RJMP    $+2
   \   000000C8   98AE               CBI     0x15, 0x06
   \   000000CA   B305               IN      R16, 0x15
   \   000000CC   7F00               ANDI    R16, 0xF0
   \   000000CE   701F               ANDI    R17, 0x0F
   \   000000D0   2B01               OR      R16, R17
   \   000000D2   BB05               OUT     0x15, R16
   \   000000D4   9AAE               SBI     0x15, 0x06
   \   000000D6   C000               RJMP    $+2
   \   000000D8   C000               RJMP    $+2
   \   000000DA   C000               RJMP    $+2
   \   000000DC   C000               RJMP    $+2
   \   000000DE   98AE               CBI     0x15, 0x06
   \   000000E0   B305               IN      R16, 0x15
   \   000000E2   600F               ORI     R16, 0x0F
   \   000000E4   BB05               OUT     0x15, R16
    154              pos = LCD_busy_AC_RD();   // read busy-flag and address counter       
   \                     ??LCD_putc_5:
   \   000000E6   98AC               CBI     0x15, 0x04
   \   000000E8   9AAD               SBI     0x15, 0x05
   \   000000EA   B304               IN      R16, 0x14
   \   000000EC   7F00               ANDI    R16, 0xF0
   \   000000EE   BB04               OUT     0x14, R16
   \   000000F0   9AAE               SBI     0x15, 0x06
   \   000000F2   C000               RJMP    $+2
   \   000000F4   C000               RJMP    $+2
   \   000000F6   C000               RJMP    $+2
   \   000000F8   C000               RJMP    $+2
   \   000000FA   B313               IN      R17, 0x13
   \   000000FC   9512               SWAP    R17
   \   000000FE   7F10               ANDI    R17, 0xF0
   \   00000100   98AE               CBI     0x15, 0x06
   \   00000102   C000               RJMP    $+2
   \   00000104   C000               RJMP    $+2
   \   00000106   C000               RJMP    $+2
   \   00000108   C000               RJMP    $+2
   \   0000010A   9AAE               SBI     0x15, 0x06
   \   0000010C   C000               RJMP    $+2
   \   0000010E   C000               RJMP    $+2
   \   00000110   C000               RJMP    $+2
   \   00000112   C000               RJMP    $+2
   \   00000114   B303               IN      R16, 0x13
   \   00000116   700F               ANDI    R16, 0x0F
   \   00000118   2B10               OR      R17, R16
   \   0000011A   98AE               CBI     0x15, 0x06
   \   0000011C   C000               RJMP    $+2
   \   0000011E   C000               RJMP    $+2
   \   00000120   C000               RJMP    $+2
   \   00000122   C000               RJMP    $+2
   \   00000124   B305               IN      R16, 0x15
   \   00000126   600F               ORI     R16, 0x0F
   \   00000128   BB05               OUT     0x15, R16
   \   0000012A   FB17               BST     R17, 7
   \   0000012C   F2E6               BRTS    ??LCD_putc_5
   \   0000012E   98AC               CBI     0x15, 0x04
   \   00000130   9AAD               SBI     0x15, 0x05
   \   00000132   B304               IN      R16, 0x14
   \   00000134   7F00               ANDI    R16, 0xF0
   \   00000136   BB04               OUT     0x14, R16
   \   00000138   9AAE               SBI     0x15, 0x06
   \   0000013A   C000               RJMP    $+2
   \   0000013C   C000               RJMP    $+2
   \   0000013E   C000               RJMP    $+2
   \   00000140   C000               RJMP    $+2
   \   00000142   B303               IN      R16, 0x13
   \   00000144   9502               SWAP    R16
   \   00000146   7F00               ANDI    R16, 0xF0
   \   00000148   98AE               CBI     0x15, 0x06
   \   0000014A   C000               RJMP    $+2
   \   0000014C   C000               RJMP    $+2
   \   0000014E   C000               RJMP    $+2
   \   00000150   C000               RJMP    $+2
   \   00000152   9AAE               SBI     0x15, 0x06
   \   00000154   C000               RJMP    $+2
   \   00000156   C000               RJMP    $+2
   \   00000158   C000               RJMP    $+2
   \   0000015A   C000               RJMP    $+2
   \   0000015C   B313               IN      R17, 0x13
   \   0000015E   701F               ANDI    R17, 0x0F
   \   00000160   2B01               OR      R16, R17
   \   00000162   98AE               CBI     0x15, 0x06
   \   00000164   C000               RJMP    $+2
   \   00000166   C000               RJMP    $+2
   \   00000168   C000               RJMP    $+2
   \   0000016A   C000               RJMP    $+2
   \   0000016C   B315               IN      R17, 0x15
   \   0000016E   601F               ORI     R17, 0x0F
   \   00000170   BB15               OUT     0x15, R17
    155          
    156                  if ( pos == LCD_START_LINE1+LCD_DISP_LENGTH ) {
   \   00000172   3100               CPI     R16, 16
   \   00000174   F449               BRNE    ??LCD_putc_6
    157                      LCD_WR((1<<LCD_DDRAM)+LCD_START_LINE2,0);    
   \   00000176   98AC               CBI     0x15, 0x04
   \   00000178   98AD               CBI     0x15, 0x05
   \   0000017A   B304               IN      R16, 0x14
   \   0000017C   600F               ORI     R16, 0x0F
   \   0000017E   BB04               OUT     0x14, R16
   \   00000180   B305               IN      R16, 0x15
   \   00000182   7F00               ANDI    R16, 0xF0
   \   00000184   600C               ORI     R16, 0x0C
   \   00000186   C020               RJMP    ??LCD_putc_7
    158                  }else if ( pos == LCD_START_LINE2+LCD_DISP_LENGTH ) {
   \                     ??LCD_putc_6:
   \   00000188   3500               CPI     R16, 80
   \   0000018A   F449               BRNE    ??LCD_putc_8
    159                      LCD_WR((1<<LCD_DDRAM)+LCD_START_LINE3,0);
   \   0000018C   98AC               CBI     0x15, 0x04
   \   0000018E   98AD               CBI     0x15, 0x05
   \   00000190   B304               IN      R16, 0x14
   \   00000192   600F               ORI     R16, 0x0F
   \   00000194   BB04               OUT     0x14, R16
   \   00000196   B305               IN      R16, 0x15
   \   00000198   7F00               ANDI    R16, 0xF0
   \   0000019A   6009               ORI     R16, 0x09
   \   0000019C   C015               RJMP    ??LCD_putc_7
    160                  }else if ( pos == LCD_START_LINE3+LCD_DISP_LENGTH ) {
   \                     ??LCD_putc_8:
   \   0000019E   3200               CPI     R16, 32
   \   000001A0   F449               BRNE    ??LCD_putc_9
    161                      LCD_WR((1<<LCD_DDRAM)+LCD_START_LINE4,0);
   \   000001A2   98AC               CBI     0x15, 0x04
   \   000001A4   98AD               CBI     0x15, 0x05
   \   000001A6   B304               IN      R16, 0x14
   \   000001A8   600F               ORI     R16, 0x0F
   \   000001AA   BB04               OUT     0x14, R16
   \   000001AC   B305               IN      R16, 0x15
   \   000001AE   7F00               ANDI    R16, 0xF0
   \   000001B0   600D               ORI     R16, 0x0D
   \   000001B2   C00A               RJMP    ??LCD_putc_7
    162                  }else if ( pos == LCD_START_LINE4+LCD_DISP_LENGTH ) {
   \                     ??LCD_putc_9:
   \   000001B4   3600               CPI     R16, 96
   \   000001B6   F4D9               BRNE    ??LCD_putc_10
    163                      LCD_WR((1<<LCD_DDRAM)+LCD_START_LINE1,0);
   \   000001B8   98AC               CBI     0x15, 0x04
   \   000001BA   98AD               CBI     0x15, 0x05
   \   000001BC   B304               IN      R16, 0x14
   \   000001BE   600F               ORI     R16, 0x0F
   \   000001C0   BB04               OUT     0x14, R16
   \   000001C2   B305               IN      R16, 0x15
   \   000001C4   7F00               ANDI    R16, 0xF0
   \   000001C6   6008               ORI     R16, 0x08
   \                     ??LCD_putc_7:
   \   000001C8   BB05               OUT     0x15, R16
   \   000001CA   9AAE               SBI     0x15, 0x06
   \   000001CC   C000               RJMP    $+2
   \   000001CE   C000               RJMP    $+2
   \   000001D0   C000               RJMP    $+2
   \   000001D2   C000               RJMP    $+2
   \   000001D4   98AE               CBI     0x15, 0x06
   \   000001D6   B305               IN      R16, 0x15
   \   000001D8   7F00               ANDI    R16, 0xF0
   \   000001DA   BB05               OUT     0x15, R16
   \   000001DC   9AAE               SBI     0x15, 0x06
   \   000001DE   C000               RJMP    $+2
   \   000001E0   C000               RJMP    $+2
   \   000001E2   C000               RJMP    $+2
   \   000001E4   C000               RJMP    $+2
   \   000001E6   98AE               CBI     0x15, 0x06
   \   000001E8   B305               IN      R16, 0x15
   \   000001EA   600F               ORI     R16, 0x0F
   \   000001EC   BB05               OUT     0x15, R16
    164                  }
   \                     ??LCD_putc_10:
   \   000001EE   98AC               CBI     0x15, 0x04
   \   000001F0   9AAD               SBI     0x15, 0x05
   \   000001F2   B304               IN      R16, 0x14
   \   000001F4   7F00               ANDI    R16, 0xF0
   \   000001F6   BB04               OUT     0x14, R16
   \   000001F8   9AAE               SBI     0x15, 0x06
   \   000001FA   C000               RJMP    $+2
   \   000001FC   C000               RJMP    $+2
   \   000001FE   C000               RJMP    $+2
   \   00000200   C000               RJMP    $+2
   \   00000202   B313               IN      R17, 0x13
   \   00000204   9512               SWAP    R17
   \   00000206   7F10               ANDI    R17, 0xF0
   \   00000208   98AE               CBI     0x15, 0x06
   \   0000020A   C000               RJMP    $+2
   \   0000020C   C000               RJMP    $+2
   \   0000020E   C000               RJMP    $+2
   \   00000210   C000               RJMP    $+2
   \   00000212   9AAE               SBI     0x15, 0x06
   \   00000214   C000               RJMP    $+2
   \   00000216   C000               RJMP    $+2
   \   00000218   C000               RJMP    $+2
   \   0000021A   C000               RJMP    $+2
   \   0000021C   B303               IN      R16, 0x13
   \   0000021E   700F               ANDI    R16, 0x0F
   \   00000220   2B10               OR      R17, R16
   \   00000222   98AE               CBI     0x15, 0x06
   \   00000224   C000               RJMP    $+2
   \   00000226   C000               RJMP    $+2
   \   00000228   C000               RJMP    $+2
   \   0000022A   C000               RJMP    $+2
   \   0000022C   B305               IN      R16, 0x15
   \   0000022E   600F               ORI     R16, 0x0F
   \   00000230   BB05               OUT     0x15, R16
   \   00000232   FB17               BST     R17, 7
   \   00000234   F2E6               BRTS    ??LCD_putc_10
   \   00000236   98AC               CBI     0x15, 0x04
   \   00000238   9AAD               SBI     0x15, 0x05
   \   0000023A   B304               IN      R16, 0x14
   \   0000023C   7F00               ANDI    R16, 0xF0
   \   0000023E   BB04               OUT     0x14, R16
   \   00000240   9AAE               SBI     0x15, 0x06
   \   00000242   C000               RJMP    $+2
   \   00000244   C000               RJMP    $+2
   \   00000246   C000               RJMP    $+2
   \   00000248   C000               RJMP    $+2
   \   0000024A   B303               IN      R16, 0x13
   \   0000024C   98AE               CBI     0x15, 0x06
   \   0000024E   C000               RJMP    $+2
   \   00000250   C000               RJMP    $+2
   \   00000252   C000               RJMP    $+2
   \   00000254   C000               RJMP    $+2
   \   00000256   9AAE               SBI     0x15, 0x06
   \   00000258   C000               RJMP    $+2
   \   0000025A   C000               RJMP    $+2
   \   0000025C   C000               RJMP    $+2
   \   0000025E   C000               RJMP    $+2
   \   00000260   B303               IN      R16, 0x13
   \   00000262   98AE               CBI     0x15, 0x06
   \   00000264   C000               RJMP    $+2
   \   00000266   C000               RJMP    $+2
   \   00000268   C000               RJMP    $+2
   \   0000026A   C000               RJMP    $+2
   \   0000026C   B305               IN      R16, 0x15
   \   0000026E   600F               ORI     R16, 0x0F
   \   00000270   BB05               OUT     0x15, R16
    165          
    166                  LCD_busy_AC_RD();
    167          
    168          }/* lcd_putc */
   \   00000272   9508               RET
   \   00000274                      REQUIRE _A_DDRC
   \   00000274                      REQUIRE _A_PORTC
   \   00000274                      REQUIRE _A_PINC
    169          
    170          
    171          

   \                                 In  segment CODE, align 2, keep-with-next
    172          void LCD_fprintstr (char __flash* p)
   \                     LCD_fprintstr:
    173          {
   \   00000000   939A               ST      -Y, R25
   \   00000002   938A               ST      -Y, R24
   \   00000004   01C8               MOVW    R25:R24, R17:R16
   \   00000006   C003               RJMP    ??LCD_fprintstr_0
    174            while (*p)
    175            {
    176              UREG a=*p++;
   \                     ??LCD_fprintstr_1:
   \   00000008   9105               LPM     R16, Z+
   \   0000000A   01CF               MOVW    R25:R24, R31:R30
    177              LCD_putc(a);
   \   0000000C   ....               RCALL   LCD_putc
    178            }
   \                     ??LCD_fprintstr_0:
   \   0000000E   01FC               MOVW    R31:R30, R25:R24
   \   00000010   9104               LPM     R16, Z
   \   00000012   2300               TST     R16
   \   00000014   F7C9               BRNE    ??LCD_fprintstr_1
    179          }
   \   00000016   9189               LD      R24, Y+
   \   00000018   9199               LD      R25, Y+
   \   0000001A   9508               RET
    180          
    181          //#pragma inline = forced

   \                                 In  segment CODE, align 2, keep-with-next
    182          void LCD_home(void)
   \                     LCD_home:
    183          {
    184              LCD_CMD(1<<LCD_HOME);
   \   00000000   E002               LDI     R16, 2
   \   00000002   ....               RJMP    LCD_CMD
    185          }
    186          
    187          //#pragma inline = forced

   \                                 In  segment CODE, align 2, keep-with-next
    188          void LCD_CLS(void)
   \                     LCD_CLS:
    189          {
    190              LCD_CMD(1<<LCD_CLR);
   \   00000000   E001               LDI     R16, 1
   \   00000002   ....               RJMP    LCD_CMD
    191          }
    192          
    193          //#pragma inline = forced

   \                                 In  segment CODE, align 2, keep-with-next
    194          void LCD_XY(UINT8 x,UINT8 y)
   \                     LCD_XY:
    195          {
    196              if ( y==0 )
   \   00000000   2311               TST     R17
   \   00000002   F411               BRNE    ??LCD_XY_0
    197                  LCD_CMD((1<<LCD_DDRAM)+LCD_START_LINE1+x);
   \   00000004   5800               SUBI    R16, 128
   \   00000006   C003               RJMP    ??LCD_XY_1
    198              else if ( y==1)
   \                     ??LCD_XY_0:
   \   00000008   3011               CPI     R17, 1
   \   0000000A   F411               BRNE    ??LCD_XY_2
    199                  LCD_CMD((1<<LCD_DDRAM)+LCD_START_LINE2+x);
   \   0000000C   5400               SUBI    R16, 64
   \                     ??LCD_XY_1:
   \   0000000E   ....               RJMP    LCD_CMD
    200              else if ( y==2)
   \                     ??LCD_XY_2:
   \   00000010   3012               CPI     R17, 2
   \   00000012   F411               BRNE    ??LCD_XY_3
    201                  LCD_CMD((1<<LCD_DDRAM)+LCD_START_LINE3+x);
   \   00000014   5700               SUBI    R16, 112
   \   00000016   CFFB               RJMP    ??LCD_XY_1
    202              else /* y==3 */
    203                  LCD_CMD((1<<LCD_DDRAM)+LCD_START_LINE4+x);
   \                     ??LCD_XY_3:
   \   00000018   5300               SUBI    R16, 48
   \   0000001A   CFF9               RJMP    ??LCD_XY_1
    204          }
    205          

   \                                 In  segment CODE, align 2, keep-with-next
    206          __z void LCD_fprintlineEE (UINT8 line, char __eeprom* p)
   \                     LCD_fprintlineEE:
    207          {
   \   00000000   924A               ST      -Y, R4
   \   00000002   93BA               ST      -Y, R27
   \   00000004   93AA               ST      -Y, R26
   \   00000006   939A               ST      -Y, R25
   \   00000008   938A               ST      -Y, R24
   \   0000000A                      REQUIRE ?Register_R4_is_cg_reg
   \   0000000A   2E40               MOV     R4, R16
   \   0000000C   01CF               MOVW    R25:R24, R31:R30
    208            UINT8 len, k;
    209            switch (line)
   \   0000000E   2300               TST     R16
   \   00000010   F039               BREQ    ??LCD_fprintlineEE_0
   \   00000012   950A               DEC     R16
   \   00000014   F039               BREQ    ??LCD_fprintlineEE_1
   \   00000016   950A               DEC     R16
   \   00000018   F031               BREQ    ??LCD_fprintlineEE_2
   \   0000001A   950A               DEC     R16
   \   0000001C   F021               BREQ    ??LCD_fprintlineEE_2
   \   0000001E   C028               RJMP    ??LCD_fprintlineEE_3
    210            {
    211            case 0:
    212              len=16;
   \                     ??LCD_fprintlineEE_0:
   \   00000020   E1A0               LDI     R26, 16
   \   00000022   C001               RJMP    ??LCD_fprintlineEE_2
    213              break;
    214            case 1:
    215              len=10;
   \                     ??LCD_fprintlineEE_1:
   \   00000024   E0AA               LDI     R26, 10
    216              break;
    217            case 2:
    218              break;
    219            case 3:
    220              break;
    221            default:
    222              return;    
    223            }
    224            k=0;
   \                     ??LCD_fprintlineEE_2:
   \   00000026   E0B0               LDI     R27, 0
    225            LCD_XY(0,line);
   \   00000028   2D14               MOV     R17, R4
   \   0000002A   E000               LDI     R16, 0
   \   0000002C   ....               RCALL   LCD_XY
    226            /*
    227            UINT8 i=16;
    228            while (i--)
    229            {
    230              LCD_putc(' ');
    231            }
    232            */
    233            LCD_XY(0,line);
   \   0000002E   2D14               MOV     R17, R4
   \   00000030   E000               LDI     R16, 0
   \   00000032   ....               RCALL   LCD_XY
   \   00000034   C006               RJMP    ??LCD_fprintlineEE_4
    234            while (*p&&(k<(len-1)))
    235            {
    236              LCD_putc(*p++);
   \                     ??LCD_fprintlineEE_5:
   \   00000036   01AC               MOVW    R21:R20, R25:R24
   \   00000038   ........           CALL    __eeget8_16
   \   0000003C   ....               RCALL   LCD_putc
   \   0000003E   9601               ADIW    R25:R24, 1
    237              k++;
   \   00000040   95B3               INC     R27
    238            }
   \                     ??LCD_fprintlineEE_4:
   \   00000042   01AC               MOVW    R21:R20, R25:R24
   \   00000044   ........           CALL    __eeget8_16
   \   00000048   2300               TST     R16
   \   0000004A   F041               BREQ    ??LCD_fprintlineEE_6
   \   0000004C   2F0B               MOV     R16, R27
   \   0000004E   E010               LDI     R17, 0
   \   00000050   2FEA               MOV     R30, R26
   \   00000052   E0F0               LDI     R31, 0
   \   00000054   9731               SBIW    R31:R30, 1
   \   00000056   170E               CP      R16, R30
   \   00000058   071F               CPC     R17, R31
   \   0000005A   F36C               BRLT    ??LCD_fprintlineEE_5
    239            while ((len-k)>0)
   \                     ??LCD_fprintlineEE_6:
   \   0000005C   2FEA               MOV     R30, R26
   \   0000005E   E0F0               LDI     R31, 0
   \   00000060   1BEB               SUB     R30, R27
   \   00000062   40F0               SBCI    R31, 0
   \   00000064   9731               SBIW    R31:R30, 1
   \   00000066   F024               BRLT    ??LCD_fprintlineEE_3
    240            {
    241              LCD_putc(' ');
   \   00000068   E200               LDI     R16, 32
   \   0000006A   ....               RCALL   LCD_putc
    242              k++;
   \   0000006C   95B3               INC     R27
   \   0000006E   CFF6               RJMP    ??LCD_fprintlineEE_6
    243            }
   \                     ??LCD_fprintlineEE_3:
   \   00000070                      REQUIRE ?Subroutine0
   \   00000070                      ;               // Fall through to label ?Subroutine0
    244          }

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine0:
   \   00000000   9189               LD      R24, Y+
   \   00000002   9199               LD      R25, Y+
   \   00000004   91A9               LD      R26, Y+
   \   00000006   91B9               LD      R27, Y+
   \   00000008   9049               LD      R4, Y+
   \   0000000A   9508               RET
    245          
    246          

   \                                 In  segment CODE, align 2, keep-with-next
    247          __z void LCD_fprintline (UINT8 line, char __flash* p)
   \                     LCD_fprintline:
    248          {
   \   00000000   924A               ST      -Y, R4
   \   00000002   93BA               ST      -Y, R27
   \   00000004   93AA               ST      -Y, R26
   \   00000006   939A               ST      -Y, R25
   \   00000008   938A               ST      -Y, R24
   \   0000000A                      REQUIRE ?Register_R4_is_cg_reg
   \   0000000A   2E40               MOV     R4, R16
   \   0000000C   01CF               MOVW    R25:R24, R31:R30
    249            UINT8 len, k;
    250            switch (line)
   \   0000000E   2300               TST     R16
   \   00000010   F039               BREQ    ??LCD_fprintline_0
   \   00000012   950A               DEC     R16
   \   00000014   F039               BREQ    ??LCD_fprintline_1
   \   00000016   950A               DEC     R16
   \   00000018   F031               BREQ    ??LCD_fprintline_2
   \   0000001A   950A               DEC     R16
   \   0000001C   F021               BREQ    ??LCD_fprintline_2
   \   0000001E   C026               RJMP    ??LCD_fprintline_3
    251            {
    252            case 0:
    253              len=16;
   \                     ??LCD_fprintline_0:
   \   00000020   E1A0               LDI     R26, 16
   \   00000022   C001               RJMP    ??LCD_fprintline_2
    254              break;
    255            case 1:
    256              len=10;
   \                     ??LCD_fprintline_1:
   \   00000024   E0AA               LDI     R26, 10
    257              break;
    258            case 2:
    259              break;
    260            case 3:
    261              break;
    262            default:
    263              return;    
    264            }
    265            k=0;
   \                     ??LCD_fprintline_2:
   \   00000026   E0B0               LDI     R27, 0
    266            LCD_XY(0,line);
   \   00000028   2D14               MOV     R17, R4
   \   0000002A   E000               LDI     R16, 0
   \   0000002C   ....               RCALL   LCD_XY
    267            /*
    268            UINT8 i=16;
    269            while (i--)
    270            {
    271              LCD_putc(' ');
    272            }
    273            */
    274            LCD_XY(0,line);
   \   0000002E   2D14               MOV     R17, R4
   \   00000030   E000               LDI     R16, 0
   \   00000032   ....               RCALL   LCD_XY
   \   00000034   C005               RJMP    ??LCD_fprintline_4
    275            while (*p&&(k<(len-1)))
    276            {
    277              LCD_putc(*p++);
   \                     ??LCD_fprintline_5:
   \   00000036   01FC               MOVW    R31:R30, R25:R24
   \   00000038   9105               LPM     R16, Z+
   \   0000003A   01CF               MOVW    R25:R24, R31:R30
   \   0000003C   ....               RCALL   LCD_putc
    278              k++;
   \   0000003E   95B3               INC     R27
    279            }
   \                     ??LCD_fprintline_4:
   \   00000040   01FC               MOVW    R31:R30, R25:R24
   \   00000042   9104               LPM     R16, Z
   \   00000044   2300               TST     R16
   \   00000046   F041               BREQ    ??LCD_fprintline_6
   \   00000048   2F0B               MOV     R16, R27
   \   0000004A   E010               LDI     R17, 0
   \   0000004C   2FEA               MOV     R30, R26
   \   0000004E   E0F0               LDI     R31, 0
   \   00000050   9731               SBIW    R31:R30, 1
   \   00000052   170E               CP      R16, R30
   \   00000054   071F               CPC     R17, R31
   \   00000056   F37C               BRLT    ??LCD_fprintline_5
    280            while ((len-k)>0)
   \                     ??LCD_fprintline_6:
   \   00000058   2FEA               MOV     R30, R26
   \   0000005A   E0F0               LDI     R31, 0
   \   0000005C   1BEB               SUB     R30, R27
   \   0000005E   40F0               SBCI    R31, 0
   \   00000060   9731               SBIW    R31:R30, 1
   \   00000062   F024               BRLT    ??LCD_fprintline_3
    281            {
    282              LCD_putc(' ');
   \   00000064   E200               LDI     R16, 32
   \   00000066   ....               RCALL   LCD_putc
    283              k++;
   \   00000068   95B3               INC     R27
   \   0000006A   CFF6               RJMP    ??LCD_fprintline_6
    284            }
   \                     ??LCD_fprintline_3:
   \   0000006C   ....               RJMP    ?Subroutine0
    285          }
    286          

   \                                 In  segment CODE, align 2, keep-with-next
    287          void LCD_init_4 (void)
   \                     LCD_init_4:
    288          {
    289            LCD_DDR=(1<<LCD_DDR)|(1<<LCD_RS)|(1<<LCD_RW)|(1<<LCD_E);
   \   00000000   B344               IN      R20, 0x14
   \   00000002   E001               LDI     R16, 1
   \   00000004   E010               LDI     R17, 0
   \   00000006   ........           CALL    ?S_SHL_L02
   \   0000000A   6700               ORI     R16, 0x70
   \   0000000C   BB04               OUT     0x14, R16
    290            _delay_ms(20);
   \   0000000E   EF0F               LDI     R16, 255
   \   00000010   EF19               LDI     R17, 249
   \   00000012   0000               NOP
   \   00000014   5001               SUBI    R16, 1
   \   00000016   4010               SBCI    R17, 0
   \   00000018   F7E1               BRNE    $-6
   \   0000001A   C000               RJMP    $+2
   \   0000001C   C000               RJMP    $+2
    291            LCD_PORT=(LCD_FUNCTION_8BIT_2LINES>>4);
   \   0000001E   E003               LDI     R16, 3
   \   00000020   BB05               OUT     0x15, R16
    292            LCD_toggle_e();
   \   00000022   9AAE               SBI     0x15, 0x06
   \   00000024   C000               RJMP    $+2
   \   00000026   C000               RJMP    $+2
   \   00000028   C000               RJMP    $+2
   \   0000002A   C000               RJMP    $+2
   \   0000002C   98AE               CBI     0x15, 0x06
    293            _delay_ms(5);
   \   0000002E   E10F               LDI     R16, 31
   \   00000030   E41E               LDI     R17, 78
   \   00000032   5001               SUBI    R16, 1
   \   00000034   4010               SBCI    R17, 0
   \   00000036   F7E9               BRNE    $-4
   \   00000038   C000               RJMP    $+2
   \   0000003A   0000               NOP
    294            LCD_toggle_e();
   \   0000003C   9AAE               SBI     0x15, 0x06
   \   0000003E   C000               RJMP    $+2
   \   00000040   C000               RJMP    $+2
   \   00000042   C000               RJMP    $+2
   \   00000044   C000               RJMP    $+2
   \   00000046   98AE               CBI     0x15, 0x06
    295            _delay_us(100); 
   \   00000048   E80F               LDI     R16, 143
   \   0000004A   E011               LDI     R17, 1
   \   0000004C   5001               SUBI    R16, 1
   \   0000004E   4010               SBCI    R17, 0
   \   00000050   F7E9               BRNE    $-4
   \   00000052   C000               RJMP    $+2
   \   00000054   0000               NOP
    296            LCD_toggle_e();
   \   00000056   9AAE               SBI     0x15, 0x06
   \   00000058   C000               RJMP    $+2
   \   0000005A   C000               RJMP    $+2
   \   0000005C   C000               RJMP    $+2
   \   0000005E   C000               RJMP    $+2
   \   00000060   98AE               CBI     0x15, 0x06
    297            _delay_us(100); 
   \   00000062   E80F               LDI     R16, 143
   \   00000064   E011               LDI     R17, 1
   \   00000066   5001               SUBI    R16, 1
   \   00000068   4010               SBCI    R17, 0
   \   0000006A   F7E9               BRNE    $-4
   \   0000006C   C000               RJMP    $+2
   \   0000006E   0000               NOP
    298            LCD_PORT=(LCD_FUNCTION_4BIT_2LINES>>4);
   \   00000070   E002               LDI     R16, 2
   \   00000072   BB05               OUT     0x15, R16
    299            LCD_toggle_e();
   \   00000074   9AAE               SBI     0x15, 0x06
   \   00000076   C000               RJMP    $+2
   \   00000078   C000               RJMP    $+2
   \   0000007A   C000               RJMP    $+2
   \   0000007C   C000               RJMP    $+2
   \   0000007E   98AE               CBI     0x15, 0x06
    300            _delay_us(100); 
   \   00000080   E80F               LDI     R16, 143
   \   00000082   E011               LDI     R17, 1
   \   00000084   5001               SUBI    R16, 1
   \   00000086   4010               SBCI    R17, 0
   \   00000088   F7E9               BRNE    $-4
   \   0000008A   C000               RJMP    $+2
   \   0000008C   0000               NOP
    301            LCD_CMD(LCD_FUNCTION_4BIT_2LINES);
   \   0000008E   E208               LDI     R16, 40
   \   00000090   ....               RCALL   LCD_CMD
    302            LCD_CMD (1<<LCD_CLR);
   \   00000092   E001               LDI     R16, 1
   \   00000094   ....               RCALL   LCD_CMD
    303            LCD_CMD ((1<<LCD_ENTRY_MODE) | (1<<LCD_ENTRY_INC));
   \   00000096   E006               LDI     R16, 6
   \   00000098   ....               RCALL   LCD_CMD
    304            LCD_CMD (LCD_DISP_ON);
   \   0000009A   E00C               LDI     R16, 12
   \   0000009C   ....               RCALL   LCD_CMD
    305            LCD_CLS();
   \   0000009E   E001               LDI     R16, 1
   \   000000A0   ....               RJMP    LCD_CMD
   \   000000A2                      REQUIRE _A_DDRC
   \   000000A2                      REQUIRE _A_PORTC
    306          }
    307          

   \                                 In  segment CODE, align 2, keep-with-next
    308          void LCD_putMETA (UINT8 mode, char c)
   \                     LCD_putMETA:
    309          {
   \   00000000   93BA               ST      -Y, R27
   \   00000002   93AA               ST      -Y, R26
   \   00000004   938A               ST      -Y, R24
   \   00000006   2F81               MOV     R24, R17
    310            static UINT8 pos, prevchar;
    311            UINT8 y, pos2;
    312            if (mode==0)            //     
   \   00000008   2300               TST     R16
   \   0000000A   F471               BRNE    ??LCD_putMETA_0
    313            {    
    314              pos=0; prevchar=0;
   \   0000000C   E000               LDI     R16, 0
   \   0000000E   9300....           STS     ??pos, R16
   \   00000012   9300....           STS     (??pos + 1), R16
    315              LCD_XY(0,2);
   \   00000016   E012               LDI     R17, 2
   \   00000018   ....               RCALL   LCD_XY
    316              for (y=0;y<=31;y++)
   \   0000001A   E280               LDI     R24, 32
    317              {
    318                 LCD_putc(' ');
   \                     ??LCD_putMETA_1:
   \   0000001C   E200               LDI     R16, 32
   \   0000001E   ....               RCALL   LCD_putc
    319              }
   \   00000020   958A               DEC     R24
   \   00000022   F409               BRNE    $+2+2
   \   00000024   C062               RJMP    ??LCD_putMETA_2
   \   00000026   CFFA               RJMP    ??LCD_putMETA_1
    320              return;
    321            }
    322            if (pos==255) return;
   \                     ??LCD_putMETA_0:
   \   00000028   9100....           LDS     R16, ??pos
   \   0000002C   3F0F               CPI     R16, 255
   \   0000002E   F409               BRNE    $+2+2
   \   00000030   C05C               RJMP    ??LCD_putMETA_2
    323            if (pos++<13) return; //   13  
   \   00000032   2F10               MOV     R17, R16
   \   00000034   9513               INC     R17
   \   00000036   9310....           STS     ??pos, R17
   \   0000003A   300D               CPI     R16, 13
   \   0000003C   F408               BRCC    $+2+2
   \   0000003E   C055               RJMP    ??LCD_putMETA_2
    324            if (c=='\'')            //   
   \   00000040   3287               CPI     R24, 39
   \   00000042   F449               BRNE    ??LCD_putMETA_3
    325            {
    326              prevchar = c;         // ,   
   \   00000044   ....               LDI     R26, LOW(??pos)
   \   00000046   ....               LDI     R27, (??pos) >> 8
   \   00000048   E207               LDI     R16, 39
   \   0000004A   9300....           STS     (??pos + 1), R16
    327              pos--;
   \   0000004E   2F01               MOV     R16, R17
   \   00000050   950A               DEC     R16
   \   00000052   930C               ST      X, R16
    328              return;
   \   00000054   C04A               RJMP    ??LCD_putMETA_2
    329            }
    330            if (prevchar=='\'') 
   \                     ??LCD_putMETA_3:
   \   00000056   9100....           LDS     R16, (??pos + 1)
   \   0000005A   3207               CPI     R16, 39
   \   0000005C   F599               BRNE    ??LCD_putMETA_4
    331            {
    332              if (c==';') pos =255; // ';   -   
   \   0000005E   338B               CPI     R24, 59
   \   00000060   F421               BRNE    ??LCD_putMETA_5
   \   00000062   EF0F               LDI     R16, 255
   \   00000064   9300....           STS     ??pos, R16
   \   00000068   C040               RJMP    ??LCD_putMETA_2
    333              else //    
    334              {
    335                   pos2=pos-14;         
   \                     ??LCD_putMETA_5:
   \   0000006A   9100....           LDS     R16, ??pos
   \   0000006E   500E               SUBI    R16, 14
    336                   if (pos2>31) return;
   \   00000070   3200               CPI     R16, 32
   \   00000072   F5D8               BRCC    ??LCD_putMETA_2
    337                   cbi (TIMSK, TOIE2);  
   \   00000074   B719               IN      R17, 0x39
   \   00000076   7B1F               ANDI    R17, 0xBF
   \   00000078   BF19               OUT     0x39, R17
    338                   LCD_XY((pos2)&0x0F,(pos2>>4)+2); //          
   \   0000007A   2F10               MOV     R17, R16
   \   0000007C   9512               SWAP    R17
   \   0000007E   701F               ANDI    R17, 0x0F
   \   00000080   5F1E               SUBI    R17, 254
   \   00000082   700F               ANDI    R16, 0x0F
   \   00000084   ....               RCALL   LCD_XY
    339                   LCD_putc(prevchar);         
   \   00000086   ....               LDI     R26, LOW(??pos)
   \   00000088   ....               LDI     R27, (??pos) >> 8
   \   0000008A   9100....           LDS     R16, (??pos + 1)
   \   0000008E   ....               RCALL   LCD_putc
    340                   pos++;
   \   00000090   910C               LD      R16, X
   \   00000092   9503               INC     R16
   \   00000094   930C               ST      X, R16
    341                   sbi (TIMSK, TOIE2);
   \   00000096   B709               IN      R16, 0x39
   \   00000098   6400               ORI     R16, 0x40
   \   0000009A   BF09               OUT     0x39, R16
    342                   pos2=pos-14;         
   \   0000009C   9100....           LDS     R16, ??pos
   \   000000A0   500E               SUBI    R16, 14
    343                   if (pos2>31) return;
   \   000000A2   3200               CPI     R16, 32
   \   000000A4   F510               BRCC    ??LCD_putMETA_2
    344                   cbi (TIMSK, TOIE2);  
   \   000000A6   B719               IN      R17, 0x39
   \   000000A8   7B1F               ANDI    R17, 0xBF
   \   000000AA   BF19               OUT     0x39, R17
    345                   LCD_XY((pos2)&0x0F,(pos2>>4)+2); //          
   \   000000AC   2F10               MOV     R17, R16
   \   000000AE   9512               SWAP    R17
   \   000000B0   701F               ANDI    R17, 0x0F
   \   000000B2   5F1E               SUBI    R17, 254
   \   000000B4   700F               ANDI    R16, 0x0F
   \   000000B6   ....               RCALL   LCD_XY
    346                   LCD_putc(c);
   \   000000B8   2F08               MOV     R16, R24
   \   000000BA   ....               RCALL   LCD_putc
    347                   prevchar=0x00;
   \   000000BC   E000               LDI     R16, 0
   \   000000BE   9300....           STS     (??pos + 1), R16
    348          //         pos++;
    349                  //  if (pos2<(31+13)) pos++;
    350                   sbi (TIMSK, TOIE2);
   \   000000C2   C010               RJMP    ??LCD_putMETA_6
    351                   return;
    352              }
    353            }
    354            //   -  1 
    355           else
    356           {
    357                   pos2=pos-14;         
   \                     ??LCD_putMETA_4:
   \   000000C4   9100....           LDS     R16, ??pos
   \   000000C8   500E               SUBI    R16, 14
    358                   if (pos2>31) return;
   \   000000CA   3200               CPI     R16, 32
   \   000000CC   F470               BRCC    ??LCD_putMETA_2
    359                   cbi (TIMSK, TOIE2);  
   \   000000CE   B719               IN      R17, 0x39
   \   000000D0   7B1F               ANDI    R17, 0xBF
   \   000000D2   BF19               OUT     0x39, R17
    360                   LCD_XY((pos2)&0x0F,(pos2>>4)+2); //          
   \   000000D4   2F10               MOV     R17, R16
   \   000000D6   9512               SWAP    R17
   \   000000D8   701F               ANDI    R17, 0x0F
   \   000000DA   5F1E               SUBI    R17, 254
   \   000000DC   700F               ANDI    R16, 0x0F
   \   000000DE   ....               RCALL   LCD_XY
    361                   LCD_putc(c);         
   \   000000E0   2F08               MOV     R16, R24
   \   000000E2   ....               RCALL   LCD_putc
    362          //         pos++;
    363                   sbi (TIMSK, TOIE2);
   \                     ??LCD_putMETA_6:
   \   000000E4   B709               IN      R16, 0x39
   \   000000E6   6400               ORI     R16, 0x40
   \   000000E8   BF09               OUT     0x39, R16
   \                     ??LCD_putMETA_2:
   \   000000EA   9189               LD      R24, Y+
   \   000000EC   91A9               LD      R26, Y+
   \   000000EE   91B9               LD      R27, Y+
   \   000000F0   9508               RET
   \   000000F2                      REQUIRE _A_TIMSK
    364           }
    365          }

   \                                 In  segment NEAR_Z, align 1, keep-with-next
   \   00000000                      REQUIRE `?<Segment init: NEAR_Z>`
   \                     ??pos:
   \   00000000                      DS8 1
   \   00000001                      DS8 1
    366          

   \                                 In  segment CODE, align 2, keep-with-next
    367          __z void LCD_putBR (char* s)
   \                     LCD_putBR:
    368          {
   \   00000000   93BA               ST      -Y, R27
   \   00000002   93AA               ST      -Y, R26
   \   00000004   01DF               MOVW    R27:R26, R31:R30
    369            LCD_XY(10,1);
   \   00000006   E011               LDI     R17, 1
   \   00000008   E00A               LDI     R16, 10
   \   0000000A   ....               RCALL   LCD_XY
   \   0000000C   C001               RJMP    ??LCD_putBR_0
    370            while (*s)
    371            {
    372              LCD_putc(*s++);
   \                     ??LCD_putBR_1:
   \   0000000E   ....               RCALL   LCD_putc
    373            }
   \                     ??LCD_putBR_0:
   \   00000010   910D               LD      R16, X+
   \   00000012   2300               TST     R16
   \   00000014   F7E1               BRNE    ??LCD_putBR_1
    374             LCD_fprintstr ("Kbs");
   \   00000016   ....               LDI     R16, LOW(`?<Constant "Kbs">`)
   \   00000018   ....               LDI     R17, (`?<Constant "Kbs">`) >> 8
   \   0000001A   ....               RCALL   LCD_fprintstr
    375          }
   \   0000001C   91A9               LD      R26, Y+
   \   0000001E   91B9               LD      R27, Y+
   \   00000020   9508               RET
    376          

   \                                 In  segment CODE, align 2, keep-with-next
    377          void LCD_softCLR()
   \                     LCD_softCLR:
    378          {
   \   00000000   938A               ST      -Y, R24
    379            UREG i;
    380            LCD_XY(10,1);
   \   00000002   E011               LDI     R17, 1
   \   00000004   E00A               LDI     R16, 10
   \   00000006   ....               RCALL   LCD_XY
    381            for (i=0;i<=37;i++) LCD_putc(' ');
   \   00000008   E286               LDI     R24, 38
   \                     ??LCD_softCLR_0:
   \   0000000A   E200               LDI     R16, 32
   \   0000000C   ....               RCALL   LCD_putc
   \   0000000E   958A               DEC     R24
   \   00000010   F7E1               BRNE    ??LCD_softCLR_0
    382          }
   \   00000012   9189               LD      R24, Y+
   \   00000014   9508               RET

   \                                 In  segment NEAR_F, align 1, keep-with-next
   \                     `?<Constant "Kbs">`:
   \   00000000   624B0073           DC8 "Kbs"

   Maximum stack usage in bytes:

     Function           CSTACK RSTACK
     --------           ------ ------
     LCD_CLS                0      2
       -> LCD_CMD           0      2
     LCD_CMD                0      2
     LCD_DATA               0      2
     LCD_XY                 0      2
       -> LCD_CMD           0      2
       -> LCD_CMD           0      2
       -> LCD_CMD           0      2
       -> LCD_CMD           0      2
     LCD_fprintline         5      2
       -> LCD_XY            5      2
       -> LCD_XY            5      2
       -> LCD_putc          5      2
       -> LCD_putc          5      2
     LCD_fprintlineEE       5      4
       -> LCD_XY            5      2
       -> LCD_XY            5      2
       -> LCD_putc          5      2
       -> LCD_putc          5      2
     LCD_fprintstr          2      2
       -> LCD_putc          2      2
     LCD_home               0      2
       -> LCD_CMD           0      2
     LCD_init_4             0      4
       -> LCD_CMD           0      2
       -> LCD_CMD           0      2
       -> LCD_CMD           0      2
       -> LCD_CMD           0      2
       -> LCD_CMD           0      2
     LCD_putBR              2      2
       -> LCD_XY            2      2
       -> LCD_putc          2      2
       -> LCD_fprintstr     2      2
     LCD_putMETA            3      2
       -> LCD_XY            3      2
       -> LCD_putc          3      2
       -> LCD_XY            3      2
       -> LCD_putc          3      2
       -> LCD_XY            3      2
       -> LCD_putc          3      2
       -> LCD_XY            3      2
       -> LCD_putc          3      2
     LCD_putc               0      2
     LCD_softCLR            1      2
       -> LCD_XY            1      2
       -> LCD_putc          1      2


   Segment part sizes:

     Function/Label    Bytes
     --------------    -----
     _A_PINC              1
     _A_DDRC              1
     _A_PORTC             1
     _A_TIMSK             1
     LCD_CMD            198
     LCD_DATA             2
     WIN1251_tab         64
     LCD_putc           628
     LCD_fprintstr       28
     LCD_home             4
     LCD_CLS              4
     LCD_XY              28
     LCD_fprintlineEE   112
     ?Subroutine0        12
     LCD_fprintline     110
     LCD_init_4         162
     LCD_putMETA        242
     pos                  2
     prevchar
     LCD_putBR           34
     LCD_softCLR         22
     ?<Constant "Kbs">    4
      Others              6

 
     4 bytes in segment ABSOLUTE
 1 586 bytes in segment CODE
     6 bytes in segment INITTAB
    68 bytes in segment NEAR_F
     2 bytes in segment NEAR_Z
 
 1 654 bytes of CODE memory (+ 6 bytes shared)
     2 bytes of DATA memory (+ 4 bytes shared)

Errors: none
Warnings: none
